---
- include_vars: "group_vars/env-production/vault.yml"

- name: create SSL + digicert certificate file
  template:
    src: "{{ cert_source }}"
    dest: "{{ laravel_https_certificate }}"
    owner: root
    group: root
    mode: 0600

- name: create SSL key file
  copy:
    content: "{{ ssl_cert_priv_key }}"
    dest: "{{ laravel_https_key }}"
    owner: root
    group: root
    mode: 0640

- name: create SSL certificate file
  copy:
    content: "{{ ssl_certs_crt }}"
    dest: "{{ sp_https_certificate }}"
    owner: root
    group: root
    mode: 0640

- name: create symlink so php saml library can find the key file
  file:
    src: "{{ laravel_https_key }}"
    dest: "{{ sp_https_key }}"
    state: link
